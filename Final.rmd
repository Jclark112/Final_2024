---
title: "Covid91 vaccine study Final2024"
author: "Put your name here!"
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
date: "`r Sys.Date()`" 
---

```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
FinalDat <-read.csv(file="finalSumr2024.csv",header=TRUE)
#recode to remove the annoying "X" from the dataframe
FinalData <- FinalDat  %>% select(-one_of("X"))
FinalData <- FinalData %>%
mutate(across(where(is.character), as.factor))
```

# Introduction

A new  preventative vaccine (covid921) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of subpopulations tracked. Consider population subgroups by gender( guys and gals), drug use, and sexual orientation. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbage when referencing p-values in conclusions.

## Males

$H_0$: The Covid921 vaccine is not effective in males. 

$H_A$: The Covid921 vaccine is effective in males. 

### Methods

The helper file used is CAT~CAT.   

Male and Treatments will be Cat.  

Male and Treatments are categorical variables. 

### Descriptive Results  

### Graphical Results  

```{r}
males=filter(FinalData,FinalData$sex=="M")
barchartGC(~treatment + infected,data=males)
barchartGC(~infected + treatment,data=males,type="percent")
```

### Numerical Results

```{r}
table1 <- xtabs(~treatment + infected,data=males)
rowPerc(table1)
colPerc(table1)
```


The chart shows that roughly 74% of the group of males which got the placebo got covid19. about 26% of the males who got the vaccine also were infected with covid19. 

### Inferential Results

```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
```

The chi-square test and the fishers exact test are both equaling to 0.000022. This indicates that the vaccine reduces the likelihood of getting Covid 19. The odds for contracting Covid 19 increase by almost 3% by the group receiving the placebo. There is a 95% confidence interval which tells us that vaccination is effective in preventing Covid 19.

## Females

$H_0$: The Covid921 vaccine is not effective in females. 

$H_A$: The Covid921 vaccine is effective in females. 

### Methods

The helper file used is CAT~CAT.  

Females and Treatments will be Cat.  

Females and Treatments are Categorical values.  

### Descriptive Results

#### Graphical Results

```{r}
females=filter(FinalData,FinalData$sex=="F")
barchartGC(~treatment + infected,data=females)
barchartGC(~infected + treatment,data=females,type="percent")
```

This graph shows that females who got the vaccine were less infected with Covid 19 then those who were given the placebo. About 50% of the females which recieved the placebo were ok and about 51% of the females with the vaccine were ok. 

#### Numerical Results

```{r}
table1 <- xtabs(~treatment + infected,data=males)
rowPerc(table1)
colPerc(table1)
```

The numerical results show that the vaccine is effective in reducing the chances of contracting covid 19 compared to the placebo.  The odds of contracting covid 19 are reduced by approximately 47% by those which received the vaccine. The vaccine lowers the risk of infection by 45% compared to the placebo. 

#### Inferential Results
 
```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
```

The chi-square test is equaling to 0.00001914. The Fishers Exact Test is 0.00001246 also confirmed the statistical significance of the infection rates between the placebo and the vaccination groups. The odds ratio of 1.8562 means that the odds of getting Covid within the placebo groups is 1.86 times more likely than the vaccine. There is a 95% confidence interval that suggests that the odds ratio is between 1.49 and 2.32, which tells us that the vaccine is most effective. We must reject the null hypothesis as the values are less than 0.05.

## LGBTQ

$H_0$: The Covid19 vaccine is not effective in the LGBTQ community.

$H_A$: The Covid19 vaccine is effective in the LGBTQ community.

### Methods

The helper files we use are Cat~Cat

LGBTQ and Treatments are Cat

LGBTQ and Treatments are categorical values

### Descriptive Results

#### Graphical Results

```{r}
LGBTQ=filter(FinalData,FinalData$LGBTQ=="gay")
barchartGC(~treatment + infected,data=LGBTQ)
barchartGC(~infected + treatment,data=LGBTQ,type="percent")
```

The table proves that within the LGBTQ community there was more infected people with Covid 19 within the group which received the placebo. The ones which got the vaccine had a significant decrease of contracting Covid 19. 


#### Numerical Summary 

```{r}
table1 <- xtabs(~treatment + infected,data=LGBTQ)
rowPerc(table1)
colPerc(table1)
```

The numerical results prove that 20% of those who got the vaccine got covid and about 80% of those who got the placebo got Covid 19. 

#### Inferential Results

```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
```

The Chi Squared test showed that the p-value is 0.00000000000000022 therefore we must reject the null hypothesis as it is a value less than 0.05. The fishers exact test shows that the p-value is 0.000000000000000022 therefore we reject the null hypothesis as its less than 0.05. The test tells us that LGBTQ have an odds ratio of 4.2 times. This means theyre more likely to get covid 19 with the placebo as opposed to the group with the vaccine. 

## Druggies

$H_0$: The Covid19 vaccine is not effective in the DrugUser community.

$H_A$: The Covid19 vaccine is effective in the DrugUser community.


### Methods

Drug Users and Treatment is a categorical value. 

LGBTQ and treatment is Cat. 

We use the helper file CAT~CAT. 

#### Descriptive Results

#### Graphical Results

```{r}
DrugUser=filter(FinalData, FinalData $DrugUser=="yes")
barchartGC(~treatment + infected,data=DrugUser)
barchartGC(~infected + treatment,data=DrugUser,type="percent")
```

The table shows that amongst drug users there was higher instances of contracting covid as the placebo group as opposed to the vaccinated group. 

#### Numerical Summary

```{r}
table1 <- xtabs(~treatment + infected,data=DrugUser)
rowPerc(table1)
colPerc(table1)
```

The results in the chart show that 69% of the placebo group contracted covid 19 and only about 31% of the vaccinated group contracted covid 19. 

#### Inferential Results

```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
```
 
 The inferential results for the chi-squared test,proved that the p-value is 0.00000000000000022 therefore we reject the null hypothesis due to it being less than 0.05. The Fisher's Exact Test showed that the p-value 0.00000000000000022 therfore we reject the null hypothesis. The test showed that the odd ratio of drug users was 2.2 times more likely to contract covid with the placebo as opposed to 
the people which got the vaccines. 
 
# Overall Results and Conclusions

The covid vaccine affected populations differently throughout each sample population studied. 

When tested if the vaccines effectiveness in the male population the inferential results going by the chi-squared test results showed that the p-value was 0.00000000000000022. The Fishers Exact Test proved that the odd ratio for the male population was 2.8 times more likely to contract Covid 19 (with placebo) as opposed to those who got the vacination. 





